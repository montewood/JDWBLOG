[{"name":"app.R","content":"library(shiny)\nlibrary(bslib)\nlibrary(bsicons)\nlibrary(jsonlite)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(purrr)\nlibrary(glue)\nlibrary(ggplot2)\nlibrary(shinycssloaders)\nlibrary(shinyjs)\n\nui <- fluidPage(\n  useShinyjs(),\n  \n  # í˜ì´ì§€ ì „ì²´ overflow ë°©ì§€ (shinylive + iframe ëŒ€ì‘)\n  tags$style(HTML(\"\n    html, body {\n      height: 100%;\n      margin: 0;\n      overflow: hidden;\n    }\n  \")),\n  \n  titlePanel(HTML(\"<b>About This blog<\/b>\")),\n  \n  # ì„¤ì • ì•„ì´ì½˜ (ë ˆì´ì•„ì›ƒ ì˜í–¥ ìµœì†Œí™”)\n  absolutePanel(\n    top = 10, right = 20, fixed = TRUE,\n    actionButton(\n      \"settings_btn\",\n      label = bs_icon(\"gear\"),\n      style = \"\n        font-size: 48px;\n        background: none;\n        border: none;\n        cursor: pointer;\n        color: #555;\n      \"\n    )\n  ),\n  \n  fluidRow(\n    # ğŸ“Š Chart ì˜ì—­\n    column(\n      12,\n      card(\n        height = \"38vh\",                # â¬…ï¸ iframe ê¸°ì¤€ ìƒëŒ€ ë†’ì´\n        style = \"overflow: hidden;\",    # â¬…ï¸ ë¯¸ì„¸ ì´ˆê³¼ í¡ìˆ˜\n        withSpinner(\n          plotOutput(\n            \"visit_plot\",\n            height = \"100%\",\n            width  = \"100%\"\n          ),\n          type = 3,\n          color = \"#F5F5F5\",\n          color.background = \"#F5F5F5\"\n        )\n      )\n    ),\n    \n    # ğŸ“¦ Value box ì˜ì—­\n    column(\n      12,\n      value_box(\n        title = \"ì´ ë°©ë¬¸ì ìˆ˜\",\n        value = uiOutput(\"row_count_ui\"),\n        showcase = bs_icon(\"people-fill\"),\n        theme = \"custom\",\n        style = \"background-color: #A67B5B; color: white;\",\n        height = \"18vh\"                 # â¬…ï¸ vh ê¸°ë°˜ (ì—¬ìœ  ìˆê²Œ)\n      )\n    )\n  )\n)\n\nserver <- function(input, output, session) {\n  \n  # ì„¤ì • íŒì—…\n  observeEvent(input$settings_btn, {\n    showModal(\n      modalDialog(\n        title = h2(HTML(\"<b>ë°©ë¬¸ì ìˆ˜<\/b>\")),\n        dateRangeInput(\n          \"date_range\",\n          \"ì¡°íšŒ ê¸°ê°„ ì„¤ì •\",\n          start = \"2024-01-01\",\n          end   = \"2024-02-28\"\n        ),\n        easyClose = TRUE,\n        footer = tagList(\n          modalButton(\"ì·¨ì†Œ\"),\n          actionButton(\"apply_settings\", \"ì ìš©\")\n        )\n      )\n    )\n  })\n  \n  observeEvent(input$apply_settings, {\n    removeModal()\n  })\n  \n  data_reactive <- reactiveVal(NULL)\n  loading_state <- reactiveVal(FALSE)\n  \n  observeEvent(input$apply_settings, {\n    req(input$date_range)\n    \n    loading_state(TRUE)\n    \n    date_seq <- seq(\n      from = input$date_range[1],\n      to   = input$date_range[2],\n      by   = \"1 day\"\n    )\n    \n    result_data <- map_df(date_seq, function(d) {\n      url <- glue(\n        \"https://raw.githubusercontent.com/montewood/gh-action/refs/heads/main/output/GA-{format(d, '%Y%m%d')}.json\"\n      )\n      tryCatch(\n        fromJSON(url) %>% fromJSON() %>% as_tibble(),\n        error = function(e) NULL\n      )\n    })\n    \n    data_reactive(result_data)\n    loading_state(FALSE)\n  })\n  \n  output$row_count_ui <- renderUI({\n    if (loading_state()) {\n      span(\"Loading...\", style = \"font-size: 20px; font-weight: bold; color: gray;\")\n    } else {\n      df <- data_reactive()\n      if (is.null(df) || nrow(df) == 0) {\n        span(\"No Data\", style = \"font-size: 20px; font-weight: bold; color: gray;\")\n      } else {\n        span(\n          paste0(sum(df$activeUsers, na.rm = TRUE), \" ëª…\"),\n          style = \"font-size: 42px; font-weight: bold;\"\n        )\n      }\n    }\n  })\n  \n  # ğŸ“Š Plot (â— ê³ ì • width/height ì œê±°ë¨)\n  output$visit_plot <- renderPlot({\n    req(data_reactive())\n    if (loading_state()) return(NULL)\n    \n    df <- data_reactive()\n    \n    agg_df <- df %>%\n      mutate(parsed_year_month = str_sub(parsed_year_month, 1, 7)) %>%\n      group_by(parsed_year_month) %>%\n      summarise(activeUsers = sum(activeUsers, na.rm = TRUE), .groups = \"drop\")\n    \n    ggplot(agg_df, aes(x = parsed_year_month, y = activeUsers)) +\n      geom_col(fill = \"#6C8EBF\") +\n      geom_text(\n        aes(label = activeUsers),\n        vjust = -0.3,\n        size = 4\n      ) +\n      labs(\n        title = \"JDW BLOG Monthly Visitor Chart\",\n        subtitle = glue(\"{input$date_range[1]} ~ {input$date_range[2]}\"),\n        x = NULL,\n        y = \"Visitors\"\n      ) +\n      theme_minimal(base_size = 14) +\n      theme(\n        plot.title   = element_text(size = 18, face = \"bold\"),\n        plot.margin  = margin(8, 8, 8, 8),\n        axis.text.x  = element_text(angle = 0)\n      )\n  }, res = 96)\n}\n\nshinyApp(ui, server)\n","type":"text"},{"name":"app-legacy.R","content":"library(shiny)\nlibrary(bslib)\nlibrary(bsicons)\nlibrary(jsonlite)\nlibrary(dplyr)\nlibrary(stringr)\nlibrary(purrr)\nlibrary(glue)\nlibrary(ggplot2)\nlibrary(shinycssloaders)\nlibrary(shinyjs)\n\nui <- fluidPage(\n  useShinyjs(),  # ğŸ”¹ shinyjs í™œì„±í™”\n  titlePanel(HTML(\"<b>About This blog<\/b>\")),\n  \n  # ğŸ”¹ ì„¤ì • ì•„ì´ì½˜ì„ í™”ë©´ ìš°ìƒë‹¨ì— ê³ ì •\n  absolutePanel(\n    top = 10, right = 20, fixed = TRUE, \n    actionButton(\"settings_btn\", label = bsicons::bs_icon(\"gear\"), \n                 style = \"font-size: 64px; background: none; border: none; cursor: pointer; color: #555;\")\n    \n  ),\n  \n  # ë©”ì¸ ë ˆì´ì•„ì›ƒ\n  fluidRow(\n    column(12,\n           card(\n             height = \"40vh\",\n             withSpinner(\n               plotOutput(\"visit_plot\", height = \"100%\", width = \"100%\"), \n               type = 3, \n               color = \"#F5F5F5\", \n               color.background = \"#F5F5F5\"\n             )\n           )\n    ),\n    column(12,\n           value_box(\n             title = \"ì´ ë°©ë¬¸ì ìˆ˜\", \n             value = uiOutput(\"row_count_ui\"),\n             showcase = bsicons::bs_icon(\"people-fill\"), \n             theme = \"custom\",\n             style = \"background-color: #A67B5B; color: white;\",\n             height = \"20vh\"\n           )\n    )\n  )\n)\n\nserver <- function(input, output, session) {\n  \n  # ì„¤ì • ë²„íŠ¼ í´ë¦­ ì‹œ íŒì—… UI í‘œì‹œ\n  observeEvent(input$settings_btn, {\n    showModal(modalDialog(\n      title = h2(HTML(\"<b>ë°©ë¬¸ì ìˆ˜<\/b>\")),\n      dateRangeInput(\"date_range\", \"ì¡°íšŒ ê¸°ê°„ ì„¤ì •\", \n                     start = \"2024-01-01\", \n                     end = \"2024-02-28\"),\n      easyClose = TRUE,\n      footer = tagList(\n        modalButton(\"ì·¨ì†Œ\"),\n        actionButton(\"apply_settings\", \"ì ìš©\")\n      )\n    ))\n  })\n  \n  # \"ì ìš©\" ë²„íŠ¼ í´ë¦­ ì‹œ íŒì—… ë‹«ê¸°\n  observeEvent(input$apply_settings, {\n    removeModal()\n  })\n  \n  # ë°ì´í„° ë¡œë”© ìƒíƒœ ê´€ë¦¬\n  data_reactive <- reactiveVal(NULL)\n  loading_state <- reactiveVal(FALSE)\n  \n  # ğŸ”¹ \"ë°©ë¬¸ì ìˆ˜ ì¡°íšŒ\" ë²„íŠ¼ í´ë¦­ ì‹œ ë°ì´í„° ë¡œë”© (íŒì—… \"ì ìš©\" ë²„íŠ¼ë„ íŠ¸ë¦¬ê±°)\n  observeEvent({ input$visit_btn; input$apply_settings }, {\n    req(input$date_range)\n    \n    loading_state(TRUE)\n    showNotification(\"Loading Data...\", type = \"message\", duration = 3)\n    \n    # ì„ íƒí•œ ë‚ ì§œ ë²”ìœ„ì˜ ë°ì´í„°ë¥¼ ë¡œë“œ\n    date_seq <- seq(from = input$date_range[1], to = input$date_range[2], by = \"1 days\")\n    \n    result_data <- map_df(date_seq, function(selected_date) {\n      selected_date_string <- format(selected_date, \"%Y%m%d\")\n      url <- paste0(\"https://raw.githubusercontent.com/montewood/gh-action/refs/heads/main/output/GA-\", \n                    selected_date_string, \".json\")\n      \n      tryCatch({\n        fromJSON(url) %>% fromJSON() %>% as_tibble()\n      }, error = function(e) {\n        NULL\n      })\n    })\n    \n    data_reactive(result_data)\n    loading_state(FALSE)\n    showNotification(\"Data Loading Complete\", type = \"message\", duration = 2)\n  })\n  \n  # ì´ ë°©ë¬¸ì ìˆ˜ UI ì¶œë ¥\n  output$row_count_ui <- renderUI({\n    if (loading_state()) {\n      span(\"Loading...\", style = \"font-size: 20px; font-weight: bold; color: gray;\")\n    } else {\n      df <- data_reactive()\n      if (is.null(df) || nrow(df) == 0) {\n        span(\"No Data\", style = \"font-size: 20px; font-weight: bold; color: gray;\")\n      } else {\n        span(paste0(sum(df$activeUsers, na.rm = TRUE), \" ëª…\"), \n             style = \"font-size: 48px; font-weight: bold; color: black;\")\n      }\n    }\n  })\n  \n  # ë°©ë¬¸ì ìˆ˜ ë³€í™” ì°¨íŠ¸ ì¶œë ¥\n  output$visit_plot <- renderPlot({\n    req(data_reactive())\n    if (loading_state()) return(NULL)\n    \n    df <- data_reactive()\n    \n    par(mar = c(1, 1, 1, 1))\n    \n    agg_df <- df %>% \n      mutate(parsed_year_month = str_sub(parsed_year_month, 1, 7)) %>% \n      group_by(parsed_year_month) %>% \n      summarise(activeUsers = sum(activeUsers, na.rm = TRUE))\n    \n    ggplot(agg_df, aes(x = parsed_year_month, y = activeUsers)) +\n      geom_col() + \n      geom_text(aes(label = activeUsers), vjust = -0.5, color = \"black\") + \n      labs(title = \"JDW BLOG Monthly Visitor Chart\", \n           subtitle = glue(\"{input$date_range[1]} ~ {input$date_range[2]}\"), \n           x = \"Year-Months\", y = \"Total Visitors\") +\n      theme_minimal() +\n      theme(\n        plot.title = element_text(size = 18, face = \"bold\", color = \"black\"),\n        axis.text = element_text(size = 14),\n        axis.title = element_text(size = 16)\n      )\n  }, width = 600, height = 400)\n}\n\nshinyApp(ui, server)\n","type":"text"},{"name":"blog_app.Rproj","content":"Version: 1.0\nProjectId: ca99f1cf-1fa0-45b4-906d-144107c3968c\n\nRestoreWorkspace: Default\nSaveWorkspace: Default\nAlwaysSaveHistory: Default\n\nEnableCodeIndexing: Yes\nUseSpacesForTab: Yes\nNumSpacesForTab: 2\nEncoding: UTF-8\n\nRnwWeave: Sweave\nLaTeX: pdfLaTeX\n","type":"text"}]
